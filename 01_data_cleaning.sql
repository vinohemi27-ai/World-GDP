-- Create database
CREATE DATABASE world_gdp;
USE world_gdp;

-- View and clean gdp_23_25
SELECT * FROM gdp_23_25;
DESC gdp_23_25;
SHOW CREATE TABLE gdp_23_25;

ALTER TABLE gdp_23_25
RENAME COLUMN `2023` TO gdp_2023,
RENAME COLUMN `2024` TO gdp_2024,
RENAME COLUMN `2025` TO gdp_2025;

ALTER TABLE gdp_23_25
MODIFY COLUMN gdp_2023 INT NULL,
MODIFY COLUMN gdp_2024 BIGINT NULL,
MODIFY COLUMN gdp_2025 BIGINT NULL;

UPDATE gdp_23_25 
SET gdp_2025 = COALESCE(gdp_2025,0);

-- View and clean gdp_20_22
SELECT * FROM gdp_20_22;

ALTER TABLE gdp_20_22
RENAME COLUMN `2020` TO gdp_2020,
RENAME COLUMN `2021` TO gdp_2021,
RENAME COLUMN `2022` TO gdp_2022;

ALTER TABLE gdp_20_22
MODIFY COLUMN gdp_2020 INT NULL,
MODIFY COLUMN gdp_2021 INT NULL,
MODIFY COLUMN gdp_2022 INT NULL;

UPDATE gdp_20_22
SET gdp_2020 = COALESCE(gdp_2020,0),
    gdp_2021 = COALESCE(gdp_2021,0),
    gdp_2022 = COALESCE(gdp_2022,0);
